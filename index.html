<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ApkaJyotish ‚Äî Clear Answers. Practical Remedies.</title>
  <meta name="description" content="Kundli-based guidance, clear answers, and practical remedies." />
  <style>
    :root{
      --bg:#0b0f17;
      --card:#111827;
      --card2:#0f172a;
      --text:#e5e7eb;
      --muted:#9ca3af;
      --line:#1f2937;
      --accent:#f59e0b;
      --accent2:#fb7185;
      --ok:#22c55e;
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --radius: 18px;
      --radius2: 26px;
      --max: 1100px;
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: var(--font);
      background:
        radial-gradient(1200px 600px at 20% 10%, rgba(245,158,11,.16), transparent 60%),
        radial-gradient(900px 500px at 80% 20%, rgba(251,113,133,.12), transparent 60%),
        radial-gradient(1000px 600px at 50% 90%, rgba(59,130,246,.10), transparent 55%),
        var(--bg);
      color: var(--text);
      -webkit-font-smoothing: antialiased;
      line-height:1.45;
    }

    a{ color:inherit; text-decoration:none; }
    .wrap{ max-width:var(--max); margin:0 auto; padding:28px 18px 80px; }

    /* Top bar */
    .topbar{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; padding:14px 16px;
      border:1px solid rgba(255,255,255,.06);
      background: rgba(15,23,42,.55);
      backdrop-filter: blur(10px);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      position: sticky; top: 14px; z-index: 50;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      font-weight:700; letter-spacing:.2px;
    }
    .logo{
      width:36px; height:36px; border-radius:12px;
      background: linear-gradient(135deg, rgba(245,158,11,1), rgba(251,113,133,1));
      display:grid; place-items:center;
      box-shadow: 0 12px 30px rgba(245,158,11,.25);
    }
    .logo span{ font-size:18px; filter: drop-shadow(0 8px 12px rgba(0,0,0,.4)); }
    .nav{
      display:flex; align-items:center; gap:10px; flex-wrap:wrap;
    }
    .pill{
      padding:8px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.09);
      background: rgba(17,24,39,.55);
      color: var(--muted);
      font-size:13px;
      transition: .15s ease;
    }
    .pill:hover{ color: var(--text); border-color: rgba(245,158,11,.35); transform: translateY(-1px); }

    .cta{
      display:flex; align-items:center; gap:10px;
    }
    .btn{
      border:0; cursor:pointer;
      padding:10px 14px;
      border-radius: 12px;
      font-weight:650;
      background: rgba(255,255,255,.06);
      color: var(--text);
      border:1px solid rgba(255,255,255,.10);
      transition: .15s ease;
    }
    .btn:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.16); }
    .btn.primary{
      background: linear-gradient(135deg, rgba(245,158,11,1), rgba(251,113,133,1));
      border:0;
      color:#0b0f17;
      box-shadow: 0 14px 36px rgba(245,158,11,.22);
    }
    .btn.primary:hover{ filter:saturate(1.05) brightness(1.02); }

    /* Hero */
    .hero{ margin-top:22px; display:grid; gap:18px; grid-template-columns: 1.25fr .75fr; }
    @media (max-width: 900px){ .hero{ grid-template-columns:1fr; } }

    .heroCard{
      border-radius: var(--radius2);
      border:1px solid rgba(255,255,255,.06);
      background: rgba(17,24,39,.55);
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .heroInner{ padding:28px 22px 24px; }
    .kicker{
      display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px; border-radius:999px;
      background: rgba(245,158,11,.12);
      border:1px solid rgba(245,158,11,.25);
      color: #ffd18a;
      font-size: 12px;
      font-weight:650;
    }
    h1{
      margin:12px 0 10px;
      font-size: 44px;
      line-height: 1.05;
      letter-spacing: -0.8px;
    }
    @media (max-width: 480px){ h1{ font-size: 34px; } }
    .sub{
      color: var(--muted);
      font-size: 15.5px;
      max-width: 60ch;
    }
    .heroActions{ margin-top:18px; display:flex; gap:10px; flex-wrap:wrap; }
    .trustRow{ margin-top:16px; display:flex; gap:10px; flex-wrap:wrap; color: var(--muted); font-size: 13px; }
    .tag{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px; border-radius: 999px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(15,23,42,.55);
    }
    .tag b{ color: var(--text); font-weight:650; }

    .sideCard{ padding:18px; }
    .sideTitle{ font-weight:750; margin:2px 0 10px; }
    .sideItem{
      display:flex; gap:10px; align-items:flex-start;
      padding:10px 0;
      border-bottom:1px dashed rgba(255,255,255,.10);
      color: var(--muted);
      font-size: 13.5px;
    }
    .sideItem:last-child{ border-bottom:0; }
    .dot{
      width:10px; height:10px; border-radius:99px; margin-top:4px;
      background: rgba(245,158,11,.9);
      box-shadow: 0 0 0 4px rgba(245,158,11,.14);
    }

    /* Sections */
    .section{ margin-top:34px; }
    .sectionHead{
      display:flex; align-items:flex-end; justify-content:space-between; gap:14px; flex-wrap:wrap;
      margin-bottom: 14px;
    }
    .sectionHead h2{
      margin:0; font-size: 22px; letter-spacing:-.2px;
    }
    .sectionHead p{ margin:0; color: var(--muted); font-size: 13.5px; }

    /* Cards grid */
    .grid{ display:grid; gap:14px; grid-template-columns: repeat(3, 1fr); }
    @media (max-width: 980px){ .grid{ grid-template-columns: repeat(2, 1fr);} }
    @media (max-width: 620px){ .grid{ grid-template-columns: 1fr;} }

    .card{
      border-radius: var(--radius);
      border:1px solid rgba(255,255,255,.07);
      background: rgba(17,24,39,.52);
      backdrop-filter: blur(10px);
      box-shadow: 0 14px 40px rgba(0,0,0,.33);
      padding:16px;
      position:relative;
      overflow:hidden;
      transition: .15s ease;
    }
    .card:hover{ transform: translateY(-2px); border-color: rgba(245,158,11,.25); }
    .cardTop{ display:flex; align-items:flex-start; justify-content:space-between; gap:10px; }
    .card h3{ margin:0; font-size: 16px; letter-spacing:-.2px; }
    .price{
      margin:10px 0 0;
      font-size: 30px;
      letter-spacing:-.8px;
      font-weight: 800;
    }
    .per{ color: var(--muted); font-size: 12px; font-weight:600; margin-left:6px; }
    .badge{
      font-size: 12px; font-weight:750;
      padding:6px 10px;
      border-radius: 999px;
      border:1px solid rgba(245,158,11,.30);
      background: rgba(245,158,11,.12);
      color: #ffd18a;
      white-space:nowrap;
    }
    .muted{ color: var(--muted); font-size: 13px; margin:10px 0 0; }
    .features{ margin:12px 0 14px; padding:0; list-style:none; display:grid; gap:8px; }
    .features li{ display:flex; gap:10px; align-items:flex-start; color: var(--muted); font-size: 13px; }
    .tick{
      width:18px; height:18px; border-radius: 999px;
      background: rgba(34,197,94,.14);
      border:1px solid rgba(34,197,94,.26);
      display:grid; place-items:center;
      color: rgba(34,197,94,1);
      flex:0 0 auto;
      margin-top:1px;
    }
    .cardActions{ display:flex; gap:10px; flex-wrap:wrap; }
    .btn.full{ width: 100%; justify-content:center; display:flex; }

    /* FAQ */
    .faq{ display:grid; gap:10px; }
    details{
      border-radius: var(--radius);
      border:1px solid rgba(255,255,255,.07);
      background: rgba(17,24,39,.48);
      padding: 12px 14px;
      box-shadow: 0 14px 40px rgba(0,0,0,.24);
    }
    summary{
      cursor:pointer;
      font-weight:700;
      list-style:none;
      outline:none;
    }
    summary::-webkit-details-marker{ display:none; }
    details p{ margin:10px 0 0; color: var(--muted); font-size: 13.5px; }

    /* Testimonials */
    .tGrid{ display:grid; gap:14px; grid-template-columns: repeat(3, 1fr); }
    @media (max-width: 980px){ .tGrid{ grid-template-columns: repeat(2, 1fr);} }
    @media (max-width: 620px){ .tGrid{ grid-template-columns: 1fr;} }
    .tCard{ padding:16px; }
    .tText{ color: var(--text); font-size: 14px; opacity:.95; margin:0 0 12px; }
    .tMeta{ color: var(--muted); font-size: 13px; display:flex; justify-content:space-between; gap:10px; }

    /* Footer */
    footer{ margin-top:44px; color: var(--muted); font-size: 13px; }
    .foot{
      display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;
      padding-top: 16px;
      border-top:1px solid rgba(255,255,255,.08);
    }

    /* Loader */
    .skeleton{
      background: linear-gradient(90deg, rgba(255,255,255,.06), rgba(255,255,255,.10), rgba(255,255,255,.06));
      background-size: 200% 100%;
      animation: shimmer 1.2s infinite;
      border-radius: 12px;
      height: 14px;
    }
    @keyframes shimmer{
      0%{ background-position: 0% 0; }
      100%{ background-position: 200% 0; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <div class="logo"><span>üî±</span></div>
        <div>
          <div style="font-size:14px">ApkaJyotish</div>
          <div style="font-size:12px;color:var(--muted);font-weight:600">Sheet-powered website</div>
        </div>
      </div>
      <div class="nav">
        <a class="pill" href="#pricing">Pricing</a>
        <a class="pill" href="#faq">FAQ</a>
        <a class="pill" href="#testimonials">Reviews</a>
      </div>
      <div class="cta">
        <button class="btn" id="refreshBtn" type="button">Refresh</button>
        <a class="btn primary" id="whatsappBtn" href="#" target="_blank" rel="noopener">WhatsApp</a>
      </div>
    </div>

    <section class="hero">
      <div class="heroCard">
        <div class="heroInner">
          <div class="kicker">‚ú® <span id="heroKicker">Vedic Guidance</span></div>
          <h1 id="heroHeadline">Clear Answers. Practical Remedies.</h1>
          <p class="sub" id="heroSub">Kundli-based guidance, focused on what matters. Simple remedies you can follow.</p>

          <div class="heroActions">
            <a class="btn primary" href="#pricing">View Pricing</a>
            <a class="btn" href="#faq">How it works</a>
          </div>

          <div class="trustRow">
            <div class="tag">‚úÖ <b>Fast</b> <span>Reply</span></div>
            <div class="tag">üîí <b>Secure</b> <span>Payments</span></div>
            <div class="tag">üßæ <b>PDF</b> <span>Report</span></div>
          </div>
        </div>
      </div>

      <div class="heroCard sideCard">
        <div class="sideTitle">What you‚Äôll get</div>
        <div class="sideItem"><span class="dot"></span><span>Clear direction for your next step (career, love, money).</span></div>
        <div class="sideItem"><span class="dot"></span><span>Simple remedies (no complicated rituals).</span></div>
        <div class="sideItem"><span class="dot"></span><span>Honest guidance based on your kundli.</span></div>
        <div class="sideItem"><span class="dot"></span><span>WhatsApp-first support.</span></div>
      </div>
    </section>

    <section class="section" id="pricing">
      <div class="sectionHead">
        <div>
          <h2>Pricing</h2>
          <p>Prices and services are pulled live from Google Sheets.</p>
        </div>
        <div style="display:flex; gap:10px; align-items:center;">
          <span class="pill" id="lastUpdated">Loading‚Ä¶</span>
        </div>
      </div>

      <div class="grid" id="pricingGrid">
        <!-- skeleton -->
        <div class="card"><div class="skeleton" style="width:45%"></div><div class="skeleton" style="width:70%;height:28px;margin-top:10px"></div><div class="skeleton" style="width:90%;margin-top:12px"></div></div>
        <div class="card"><div class="skeleton" style="width:40%"></div><div class="skeleton" style="width:65%;height:28px;margin-top:10px"></div><div class="skeleton" style="width:92%;margin-top:12px"></div></div>
        <div class="card"><div class="skeleton" style="width:50%"></div><div class="skeleton" style="width:60%;height:28px;margin-top:10px"></div><div class="skeleton" style="width:85%;margin-top:12px"></div></div>
      </div>
    </section>

    <section class="section" id="faq">
      <div class="sectionHead">
        <div>
          <h2>FAQ</h2>
          <p>Quick answers before you book.</p>
        </div>
      </div>
      <div class="faq" id="faqList"></div>
    </section>

    <section class="section" id="testimonials">
      <div class="sectionHead">
        <div>
          <h2>Reviews</h2>
          <p>Real feedback (sheet-driven).</p>
        </div>
      </div>
      <div class="tGrid" id="tGrid"></div>
    </section>

    <footer>
      <div class="foot">
        <div>¬© <span id="year"></span> ApkaJyotish</div>
        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <span class="pill">üåê <span id="siteDomain">apkajyotish.com</span></span>
          <a class="pill" href="/api/config?nocache=1" target="_blank" rel="noopener">View API</a>
        </div>
      </div>
    </footer>
  </div>

  <script>
    // --- Helpers ---
    const $ = (id) => document.getElementById(id);
    const escapeHtml = (s) => String(s ?? "").replace(/[&<>"']/g, (m) => ({
      "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
    }[m]));

    function buildWhatsApp(number, text){
      const n = (number || "").replace(/[^\d]/g, "");
      const msg = encodeURIComponent(text || "Hi, I want to book a Kundli reading.");
      if(!n) return "#";
      return `https://wa.me/${n}?text=${msg}`;
    }

    // Placeholder payment function
    window.payNow = (serviceId, amount) => {
      alert(`Pay flow placeholder\\nService: ${serviceId}\\nAmount: ‚Çπ${amount}`);
      // Later: call your Razorpay Worker/endpoint here.
    };

    async function loadConfig({ noCache = false } = {}) {
      const url = noCache ? "/api/config?nocache=1" : "/api/config";
      const res = await fetch(url, { cache: "no-store" });
      if(!res.ok) throw new Error("Failed to load config");
      return await res.json();
    }

    function render(cfg) {
      // Hero from banners (fallbacks)
      const banners = cfg.banners || {};
      $("heroHeadline").textContent = banners.heroHeadline || "Clear Answers. Practical Remedies.";
      $("heroSub").textContent = banners.heroSub || "Kundli-based guidance, focused on what matters. Simple remedies you can follow.";
      $("heroKicker").textContent = banners.heroKicker || "Vedic Guidance";

      // WhatsApp button
      const whatsapp = banners.whatsappNumber || "";
      $("whatsappBtn").href = buildWhatsApp(whatsapp, "Hi, I want to book a reading.");
      $("whatsappBtn").style.opacity = whatsapp ? "1" : ".6";

      // Pricing
      const currency = cfg.currency || "INR";
      const services = (cfg.services || []).filter(s => s && s.active !== false);
      const grid = $("pricingGrid");

      if (!services.length) {
        grid.innerHTML = `
          <div class="card" style="grid-column:1/-1">
            <h3>No active services found</h3>
            <p class="muted">Check your Google Sheet: set <b>active</b> to TRUE for services.</p>
            <div class="cardActions" style="margin-top:12px">
              <a class="btn primary" href="/api/config?nocache=1" target="_blank" rel="noopener">Debug API</a>
              <button class="btn" onclick="location.reload()">Reload</button>
            </div>
          </div>
        `;
      } else {
        grid.innerHTML = services.map(s => `
          <div class="card">
            <div class="cardTop">
              <h3>${escapeHtml(s.name)}</h3>
              ${s.badge ? `<span class="badge">${escapeHtml(s.badge)}</span>` : ``}
            </div>
            <div class="price">‚Çπ${Number(s.price).toLocaleString("en-IN")}<span class="per">/ reading</span></div>
            <p class="muted">WhatsApp guidance + practical remedies.</p>
            <ul class="features">
              <li><span class="tick">‚úì</span><span>Personalized analysis</span></li>
              <li><span class="tick">‚úì</span><span>Clear next steps</span></li>
              <li><span class="tick">‚úì</span><span>Simple remedies</span></li>
            </ul>
            <div class="cardActions">
              <button class="btn primary full" onclick="payNow('${escapeHtml(s.id)}', ${Number(s.price)})">Pay ‚Çπ${Number(s.price).toLocaleString("en-IN")}</button>
            </div>
          </div>
        `).join("");
      }

      // FAQ
      const faq = (cfg.faq || []).filter(f => f && f.active !== false);
      const faqEl = $("faqList");
      faqEl.innerHTML = faq.length
        ? faq.map(item => `
            <details>
              <summary>${escapeHtml(item.q)}</summary>
              <p>${escapeHtml(item.a)}</p>
            </details>
          `).join("")
        : `<div class="card"><h3>No FAQs yet</h3><p class="muted">Add rows in your <b>faq</b> sheet (active TRUE).</p></div>`;

      // Testimonials
      const t = (cfg.testimonials || []).filter(t => t && t.active !== false);
      const tGrid = $("tGrid");
      tGrid.innerHTML = t.length
        ? t.map(x => `
            <div class="card tCard">
              <p class="tText">‚Äú${escapeHtml(x.text)}‚Äù</p>
              <div class="tMeta">
                <span><b style="color:var(--text)">${escapeHtml(x.name)}</b></span>
                <span>${escapeHtml(x.city || "")}</span>
              </div>
            </div>
          `).join("")
        : `<div class="card" style="grid-column:1/-1"><h3>No reviews yet</h3><p class="muted">Add rows in <b>testimonials</b> sheet (active TRUE).</p></div>`;

      $("lastUpdated").textContent = `Updated: ${new Date().toLocaleString()}`;
    }

    async function boot(noCache=false){
      try{
        const cfg = await loadConfig({ noCache });
        render(cfg);
      } catch(e){
        $("pricingGrid").innerHTML = `
          <div class="card" style="grid-column:1/-1">
            <h3>Could not load config</h3>
            <p class="muted">${escapeHtml(e.message || e)}</p>
            <div class="cardActions" style="margin-top:12px">
              <a class="btn primary" href="/api/config?nocache=1" target="_blank" rel="noopener">Open API</a>
              <button class="btn" onclick="boot(true)">Retry (no cache)</button>
            </div>
          </div>`;
      }
    }

    $("refreshBtn").addEventListener("click", () => boot(true));
    $("year").textContent = new Date().getFullYear();

    boot(false);
  </script>
</body>
</html>
